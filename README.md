# Bookkeeping - SQL-Server

## תיאור כללי

מסד נתונים זה נועד לניהול מערכת חשבוניות עבור עסקים, כולל תמיכה בתנאי תשלום, שערי מע"מ, מטבעות, לקוחות, חשבוניות ופרטי פריטים בחשבונית.
המערכת בנויה בצורה יחסית גמישה כך שתאפשר ניתוחים עתידיים, הנפקת דוחות, והרחבה לפיצ'רים מתקדמים.

## מבנה סכימה

### PaymentTerms

טבלת תנאי תשלום גמישים, כולל תמיכה ב"שוטף + X" עם לוגיקה של סוף חודש:

* `Months`, `Days` – לייצוג פרק הזמן לאחר סוף החודש.
* `NeedsEndOfMonth` – דגל האם להתחיל לספור מהחודש הנוכחי הבא.

---

### Bookkeepers

רשימת מנהלי חשבונות. משויכים ללקוחות ולחשבוניות, לצורכי אחריות ומעקב.

---

### VatRates

שיעורי מע"מ לפי תאריך התחלה.
המערכת תומכת בשיעורים משתנים לאורך זמן.

---

### Currencies

טבלת קודי מטבע תלת-ספרתיים לפי ISO 4217.

---

### Customers

טבלת לקוחות, כולל פרטי קשר, מען, ו-VAT.
שדה `CustomerType` נועד לתמיכה בסיווגים כגון "לקוחות", "לקוחות חובות מסופקים" ועוד.

---

### InvoicesHeader

טבלת כותרת חשבונית. מקושרת ללקוח, מטבע, תנאי תשלום ומנהל חשבונות.
מכילה שדה תיאור כללי ותאריך אסמכתא.

---

### InvoicesItems

שורות פריטים לחשבונית:

* כוללת תיאור, כמות, מחיר יחידה, סכום מחושב (שדה מחושב).
* אפשרות למע"מ שונה לכל שורה (או ללא מע"מ בכלל).

---

## קשרים בין טבלאות

* לקוח ← מנהל חשבונות: כל לקוח משויך למנהל חשבונות אחד.
* חשבונית ← לקוח, מנהל חשבונות, תנאי תשלום, מטבע.
* פריט חשבונית ← כותרת חשבונית, שיעור מע"מ.

---

## הערות תכנוניות

* **Normalization**: הסכמה ממודלת ברובה ב-3NF – מניעת כפילויות, שמירה על עקביות נתונים.
* **Extensibility**: כל טבלה בנויה כך שיהיה קל להוסיף שדות עתידיים (כגון הנחות, סטטוסים, סוגי מסמכים וכו').
* **Data Integrity**: שימוש עקבי ב-`FOREIGN KEY` עם שמות ברורים וידידותיים.
* **תאריכים**: תכנון עתידי לחישוב אוטומטי של תאריכי פירעון לפי תנאי תשלום.
* **i18n**: תמיכה ב-NVARCHAR מאפשרת כתיבה בעברית ובאנגלית.

## דרישות מערכת

* SQL Server 2019 ומעלה (תמיכה ב-`GENERATED COLUMNS` מוגבלת לגרסאות חדשות)
* תמיכה בעברית במסד הנתונים (קידוד Unicode – NVARCHAR)